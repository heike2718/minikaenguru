# -------------------------------------------------------------------------------
#          Allgemeine Konfigurationen
# -------------------------------------------------------------------------------
env=prod
stage=prod

delay.milliseconds = 0

heartbeat.id=ueberschreiben

adv.auftragnehmer.strasse-hausnummer=Schulthei\u00dfweg 25
adv.auftragnehmer.plz-ort-inland=55252 Mainz-Kastel
adv.auftragnehmer.plz-ort-ausland=DE-55252 Mainz-Kastel

syncToken.validity.period.minutes=2

admin.created.uri.prefix=https://mathe-jung-alt.de/mk-gateway/admin

emails.testempfaenger=hdwinkel@egladil.de,info@egladil.de
emails.groupsize=35
emails.wartezeitMinSec=25
emails.wartezeitMaxSec=65
emails.mockup=false

# UUID meines Testlehrers auf der Umgebung
uuid.testlehrer=ueberschreiben

### katalogadmin
admin.secret=ueberschreiben

### downloads
path.external.files=/deployments/files

### upload (1 MB)
upload.max.bytes=1048576

quarkus.http.body.handle-file-uploads=true
quarkus.http.body-handler.uploads-directory=/deployments/files/upload


# Http
quarkus.http.root-path=mk-gateway
quarkus.http.port=9510
quarkus.http.test-port=9511

# === START authprovider ===

### mkv-app
mkv-app.client-id=ueberschreiben
mkv-app.client-secret=ueberschreiben
mkv-app.redirect-url.login=https://mathe-jung-alt.de/mkv-app
mkv-app.redirect-url.signup=https://mathe-jung-alt.de/mkv-app

### mkadmin-app
mk-admin-app.client-id=ueberschreiben
mk-admin-app.client-secret=ueberschreiben
mk-admin-app.redirect-url.login=https://mathe-jung-alt.de/mk-admin-app

# -------------------------------------------------------------------------------
#          WEB-Security
# -------------------------------------------------------------------------------
quarkus.http.cors=true
quarkus.http.cors.origins = https://mathe-jung-alt.de,https://opa-wetterwachs.de,https://unsichtbare-homepage.de
# Achtung: mod-security verbietet standardmaessig PUT und DELETE.
# Daher parallel in /etc/apache2/sites-available/opa-wetterwachs.conf die rule 911100 f√ºr profil-server entfernen,
# sonst bekommt man 403

quarkus.http.cors.methods = POST, PUT, GET, HEAD, OPTIONS, DELETE
quarkus.http.cors.headers = Content-Type, Accept, X-Requested-With, Content-Disposition, X-XSRF-TOKEN, X-SESSIONID
quarkus.http.cors.exposed-headers = Content-Type,Content-Disposition,X-XSRF-TOKEN
quarkus.http.cors.access-control-max-age=6H

block.on.missing.origin.referer=false
target.origin=mathe-jung-alt.de


# --------------------------------------------------------------------------------
#           Authentifizierung
# --------------------------------------------------------------------------------
authprovider.url=https://mathe-jung-alt.de/authprovider
auth-app.url=https://mathe-jung-alt.de/auth-app

# --------------------------------------------------------------------------------
#           REST-Clients
# --------------------------------------------------------------------------------

## InitAccessTokenRestClient start
quarkus.rest-client."de.egladil.web.mk_gateway.domain.auth.client.InitAccessTokenRestClient".url=https://mathe-jung-alt.de/authprovider
quarkus.rest-client."de.egladil.web.mk_gateway.domain.auth.client.InitAccessTokenRestClient".scope=ApplicationScoped
quarkus.rest-client."de.egladil.web.mk_gateway.domain.auth.client.InitAccessTokenRestClient".connect-timeout=60000
quarkus.rest-client."de.egladil.web.mk_gateway.domain.auth.client.InitAccessTokenRestClient".read-timeout=120000

## TokenExchangeRestClient start
quarkus.rest-client."de.egladil.web.mk_gateway.domain.auth.session.tokens.TokenExchangeRestClient".url=https://mathe-jung-alt.de/authprovider
quarkus.rest-client."de.egladil.web.mk_gateway.domain.auth.session.tokens.TokenExchangeRestClient".scope=ApplicationScoped
quarkus.rest-client."de.egladil.web.mk_gateway.domain.auth.session.tokens.TokenExchangeRestClient".connect-timeout=60000
quarkus.rest-client."de.egladil.web.mk_gateway.domain.auth.session.tokens.TokenExchangeRestClient".read-timeout=120000

## Kataloge Rest-Client start
quarkus.rest-client."de.egladil.web.mk_gateway.infrastructure.messaging.MkKatalogeRestClient".url=http://mk-kataloge:9530
quarkus.rest-client."de.egladil.web.mk_gateway.infrastructure.messaging.MkKatalogeRestClient".scope=ApplicationScoped
quarkus.rest-client."de.egladil.web.mk_gateway.infrastructure.messaging.MkKatalogeRestClient".connect-timeout=60000
quarkus.rest-client."de.egladil.web.mk_gateway.infrastructure.messaging.MkKatalogeRestClient".read-timeout=120000

## Filescanner-REST-Client
quarkus.rest-client."de.egladil.web.mk_gateway.infrastructure.restclient.FilescannerRestClient".url=ueberschreiben
quarkus.rest-client."de.egladil.web.mk_gateway.infrastructure.restclient.FilescannerRestClient".scope=ApplicationScoped
quarkus.rest-client."de.egladil.web.mk_gateway.infrastructure.restclient.FilescannerRestClient".connect-timeout=5000
quarkus.rest-client."de.egladil.web.mk_gateway.infrastructure.restclient.FilescannerRestClient".read-timeout=30000


# --------------------------------------------------------------------------------
#           Datenbank
# --------------------------------------------------------------------------------
## DB-Properties
quarkus.datasource.db-kind=mariadb
quarkus.datasource.jdbc.url=jdbc:mariadb://mk-wettbewerb-database:3306/mk_wettbewerb
quarkus.datasource.username=mk_wettbewerb
quarkus.datasource.password=ueberschreiben

quarkus.hibernate-orm.log.sql=false
quarkus.datasource.jdbc.min-size=4
quarkus.datasource.jdbc.max-size=16

quarkus.hibernate-orm.validate-in-dev-mode=false

# ----------------------------------------------------------------------------------------------------------------------------
#           Flyway: war ein Fiasko. DB war anschlieﬂend leer und nach switch auf validate = false startete Quarkus nicht mehr
# ----------------------------------------------------------------------------------------------------------------------------
#quarkus.flyway.connect-retries=2
#quarkus.flyway.default-schema=mk_wettbewerb
#quarkus.flyway.table=schema_version
#quarkus.flyway.migrate-at-start=true
#quarkus.flyway.validate-on-migrate=false
#quarkus.flyway.clean-on-validation-error=true

# --------------------------------------------------------------------------------
#           Logging
# --------------------------------------------------------------------------------
quarkus.log.console.format=%d{yyyy-MM-dd HH:mm:ss,SSS} %p (%t) clientId=%X{clientId}, correlationId=%X{correlationId}, [%c:%L] %s%e%n
quarkus.log.level=WARN

quarkus.log.file.enable=true
quarkus.log.file.level=INFO
quarkus.log.file.path=/tmp/mk-gateway.log
quarkus.log.file.format=%d{yyyy-MM-dd HH:mm:ss.SSS} %-5p clientId=%X{clientId}, correlationId=%X{correlationId} [%c{2.}] (%t) %s%e%n
quarkus.log.file.rotation.file-suffix=.yyyy-MM-dd

quarkus.log.category."io.netty.channel.DefaultChannelPipeline".level=ERROR
quarkus.log.category."de.egladil.web.mk_gateway".level=INFO

quarkus.http.access-log.enabled = true
quarkus.http.record-request-start-time=true
quarkus.http.access-log.pattern = %h %l %u [%t] "%r" %s %b "%{i,Referer}" "%{i,User-Agent}"
qquarkus.http.access-log.log-to-file = true
quarkus.http.access-log.base-file-name = mk-gateway-access
quarkus.http.access-log.log-directory = /tmp
quarkus.http.access-log.rotate = true

# --------------------------------------------------------------------------------
#           JWT
# --------------------------------------------------------------------------------
mp.jwt.verify.publickey.location=META-INF/authprov_public_key.pem
mp.jwt.verify.issuer=heike2718/authprovider

# --------------------------------------------------------------------------------
#           Vert.x
# --------------------------------------------------------------------------------
quarkus.vertx.prefer-native-transport=true

quarkus.http.so-reuse-port=true
quarkus.http.tcp-quick-ack=true
quarkus.http.tcp-cork=true
quarkus.http.tcp-fast-open=true

# --------------------------------------------------------------------------------
#           ClamAV
# --------------------------------------------------------------------------------
clamav.host = ueberschreiben
clamav.port = 3310
clamav.timeout = 1000
zip.max_expected_compression_ratio = 100
### upload (2 MB)
upload.max.bytes=2097152

## Konfiguration Telegram-BOT
telegram.activated = false
telegram.secret = will-be-replaced
telegram.chatId = 1111111

## SMTP
email.credentials.source.file=false

email.credentials.path=null

email.activated = false
email.host = will-be-replaced
email.port = 111
email.user = will-be-replaced
email.password = will-be-replaced
email.to = will-be-replaced
